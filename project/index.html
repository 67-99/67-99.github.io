<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>项目主页</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <!-- 导航栏 -->
    <nav>
        <div class="nav-container">
            <div class="logo">67-99</div>
            <ul class="nav-links">
                <li><a href="../index.html">首页</a></li>
                <li class="dropdown">
                    <a href="index.html">项目</a>
                    <ul class="dropdown-menu">
                        <li><a href="#online">在线项目</a></li>
                        <li><a href="#offline">离线项目</a></li>
                    </ul>
                </li>
                <li><a href="https://67-99.github.io/shade/index.html">画廊</a></li>
            </ul>
            <div class="mobile-menu">☰</div>
        </div>
    </nav>
    
    <!-- 主内容区域 -->
    <div class="container">
        <!-- 作品展示区域 -->
        <main class="works" id="works-container">
            <!-- 内容将通过JavaScript动态生成 -->
            <div class="loading">正在加载项目内容...</div>
        </main>
    </div>
    
    <script>
        // 动态生成内容
        document.addEventListener('DOMContentLoaded', function() {
            fetch('./content.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('网络响应不正常');
                    }
                    return response.json();
                })
                .then(data => {
                    displayProjects(data);
                })
                .catch(error => {
                    console.error('加载项目内容失败:', error);
                    document.getElementById('works-container').innerHTML = 
                        '<div class="error">加载项目内容失败，请稍后重试。</div>';
                });
            
            function displayProjects(data) {
                const worksContainer = document.getElementById('works-container');
                worksContainer.innerHTML = '';
                
                // 遍历每个分类
                Object.keys(data).forEach(categoryKey => {
                    const category = data[categoryKey];
                    const categorySection = document.createElement('section');
                    categorySection.className = 'category';
                    categorySection.id = categoryKey;
                    
                    const categoryTitle = document.createElement('h2');
                    categoryTitle.textContent = category.name;
                    categorySection.appendChild(categoryTitle);
                    
                    const workGrid = document.createElement('div');
                    workGrid.className = 'work-grid';
                    
                    // 遍历每个项目
                    category.projects.forEach(project => {
                        const workItem = document.createElement('div');
                        workItem.className = 'work-item';
                        
                        const workImg = document.createElement('img');
                        // 根据name字段生成图片URL
                        workImg.src = `https://67-99.github.io/icon/${project.name}.png`;
                        workImg.alt = project.title;
                        workImg.className = 'work-img';
                        workItem.appendChild(workImg);
                        
                        const workContent = document.createElement('div');
                        workContent.className = 'work-content';
                        
                        const workTitle = document.createElement('h3');
                        workTitle.textContent = project.title;
                        workContent.appendChild(workTitle);
                        
                        const workDescription = document.createElement('p');
                        workDescription.innerHTML = project.description;
                        workContent.appendChild(workDescription);
                        
                        const workLink = document.createElement('a');
                        // 根据name字段生成链接
                        workLink.href = `${project.name}/index.html`;
                        workLink.className = 'work-link';
                        workLink.textContent = '查看项目';
                        workContent.appendChild(workLink);
                        
                        workItem.appendChild(workContent);
                        workGrid.appendChild(workItem);
                    });
                    
                    categorySection.appendChild(workGrid);
                    worksContainer.appendChild(categorySection);
                });

                // 添加hashchange监听器，处理页面内锚点跳转
                if (window.location.hash) {
                    const id = window.location.hash.substring(1);
                    const element = document.getElementById(id);
                    if (element) {
                        setTimeout(() => {
                            element.scrollIntoView({ behavior: 'smooth' });
                        }, 100); // 延迟100ms确保内容已渲染
                    }
                }
            }
            
            // 调整移动端导航菜单显示
            window.addEventListener('resize', function() {
                if (window.innerWidth > 900) {
                    document.querySelector('.nav-links').style.display = 'flex';
                } else {
                    document.querySelector('.nav-links').style.display = 'none';
                }
            });

            // 监听hash变化（用户点击同一页面的锚点链接）
            window.addEventListener('hashchange', function() {
                const id = window.location.hash.substring(1);
                const element = document.getElementById(id);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>